<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<manialink name="ESC:patreon-widget" id="patreon-widget" version="3">
    <frame pos="{config('patreon.pos.visible')|noescape}" id="widget">
        <quad id="background" pos="0 0" size="8 10" bgcolor="{config('colors.ui.widget.bg.color')}" opacity="0.6" z-index="-1" ScriptEvents="1" />

        <frame z-index="2">
            <quad pos="4 -4" size="4 4" halign="center" valign="center" image="https://raw.githubusercontent.com/EvoTM/EvoSC/master/core/Modules/patreon-button/patreon.png" imagefocus="" />

            <label id="time" pos="4 -8.2" size="6 1" valign="center" halign="center" textsize="0.002" text="Patreon" textfont="{config('colors.ui.font')|noescape}" />
        </frame>
    </frame>

    <script>
        <!--
        #Include "TextLib" as TL
    --></script>

    {include 'scripts.hide'}

    <script><!--
        main() {
            declare widget <=> (Page.MainFrame.GetFirstChild("widget") as CMlFrame);
            declare background <=> (Page.MainFrame.GetFirstChild("background") as CMlQuad);

            while(True){
                yield;

                foreach(event in PendingEvents){
                    if(event.Control == background && event.Type == CMlScriptEvent::Type::MouseClick){
                        OpenLink("{config('patreon.url')|noescape}", ::LinkType::ExternalBrowser);
                    }
                    if(event.Control == background && event.Type == CMlScriptEvent::Type::MouseOver){
                        AnimMgr.Add(background, """<quad opacity="0.95" bgcolor="e54" />""", 100, CAnimManager::EAnimManagerEasing::Linear);
                    }
                    if(event.Control == background && event.Type == CMlScriptEvent::Type::MouseOut){
                        AnimMgr.Add(background, """<quad opacity="0.75" bgcolor="{config('colors.ui.widget.bg.color')|noescape}" />""", 100, CAnimManager::EAnimManagerEasing::Linear);
                    }
                }

                hidescript();
            }
        }
    --></script>
</manialink>